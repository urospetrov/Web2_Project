{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\irenv\\\\Desktop\\\\Web2-Front\\\\src\\\\components\\\\StarePorudzbine.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport jwtDecode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StarePorudzbine = () => {\n  _s();\n  const [porudzbine, setPorudzbine] = useState([]);\n  const [preostaloVreme, setPreostaloVreme] = useState({});\n  const formatDate = dateString => {\n    const options = {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\",\n      hour12: false\n    };\n    return new Date(dateString).toLocaleDateString(\"en-US\", options).replace(\",\", \"\");\n  };\n  useEffect(() => {\n    var token = localStorage.getItem(\"token\");\n    const decodedToken = jwtDecode(token);\n    console.log(decodedToken[\"Id\"]);\n    if (!token) {\n      console.error(\"Token nije prisutan u localStorage-u.\");\n      return; // Ovde možete izvršiti odgovarajuće akcije ukoliko token nije prisutan.\n    }\n\n    // Pretpostavićemo da se JWT token sastoji iz tri dela (header, payload, signature) razdvojenih tačkom.\n    var tokenParts = token.split(\".\");\n    if (tokenParts.length !== 3) {\n      console.error(\"Neispravan format tokena.\");\n      return; // Ovde možete izvršiti odgovarajuće akcije ukoliko format nije ispravan.\n    }\n\n    fetch(`https://localhost:44388/Porudzbina/allPorudzbineProdavcaStare?korisnikId=${decodedToken[\"Id\"]}`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      },\n      mode: \"cors\"\n    }).then(response => response.json()).then(data => {\n      console.log(data);\n      setPorudzbine(data);\n    }).catch(error => {\n      console.log(decodedToken[\"Id\"]);\n      console.error(\"Greška prilikom dobavljanja podataka sa servera:\", error);\n    });\n  }, []);\n  const calculateRemainingTime = endTime => {\n    const currentTime = new Date().getTime();\n    const endTimeMillis = new Date(endTime).getTime();\n    return Math.max(0, endTimeMillis - currentTime);\n  };\n  useEffect(() => {\n    // ... ostatak vašeg postojećeg useEffect-a ...\n\n    // Pokretanje intervala za ažuriranje preostalog vremena svake sekunde\n    const interval = setInterval(() => {\n      const updatedRemainingTimes = {};\n      porudzbine.forEach(porudzbina => {\n        const remainingTime = calculateRemainingTime(porudzbina.vremeIsporuke);\n        updatedRemainingTimes[porudzbina.id] = remainingTime;\n      });\n      setPreostaloVreme(updatedRemainingTimes);\n    }, 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [porudzbine]);\n  const formatRemainingTime = remainingTime => {\n    const days = Math.floor(remainingTime / (24 * 60 * 60 * 1000));\n    const hours = Math.floor(remainingTime % (24 * 60 * 60 * 1000) / (60 * 60 * 1000));\n    const minutes = Math.floor(remainingTime % (60 * 60 * 1000) / (60 * 1000));\n    const seconds = Math.floor(remainingTime % (60 * 1000) / 1000);\n    return `${days}d ${hours}h ${minutes}m ${seconds}s`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        color: \"#279980\"\n      },\n      children: \"Moje porudzbine\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            style: {\n              color: \"#279980\"\n            },\n            children: \"Adresa Dostave\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            style: {\n              color: \"#279980\"\n            },\n            children: \"Komentar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            style: {\n              color: \"#279980\"\n            },\n            children: \"Vreme isporuke\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: porudzbine.filter(porudzbina => !porudzbina.otkazana).map((porudzbina, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: porudzbina.adresaDostave\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: porudzbina.komentar\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: preostaloVreme[porudzbina.id] > 0 ? formatRemainingTime(preostaloVreme[porudzbina.id]) : \"Isporuceno\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this);\n};\n_s(StarePorudzbine, \"dvYRBcBpnCCSzkRhXpevsHvjjns=\");\n_c = StarePorudzbine;\nexport default StarePorudzbine;\nvar _c;\n$RefreshReg$(_c, \"StarePorudzbine\");","map":{"version":3,"names":["React","useEffect","useState","jwtDecode","jsxDEV","_jsxDEV","StarePorudzbine","_s","porudzbine","setPorudzbine","preostaloVreme","setPreostaloVreme","formatDate","dateString","options","year","month","day","hour","minute","second","hour12","Date","toLocaleDateString","replace","token","localStorage","getItem","decodedToken","console","log","error","tokenParts","split","length","fetch","method","headers","Authorization","mode","then","response","json","data","catch","calculateRemainingTime","endTime","currentTime","getTime","endTimeMillis","Math","max","interval","setInterval","updatedRemainingTimes","forEach","porudzbina","remainingTime","vremeIsporuke","id","clearInterval","formatRemainingTime","days","floor","hours","minutes","seconds","children","style","color","fileName","_jsxFileName","lineNumber","columnNumber","filter","otkazana","map","index","adresaDostave","komentar","_c","$RefreshReg$"],"sources":["C:/Users/irenv/Desktop/Web2-Front/src/components/StarePorudzbine.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport jwtDecode from \"jwt-decode\";\r\n\r\nconst StarePorudzbine = () => {\r\n  const [porudzbine, setPorudzbine] = useState([]);\r\n  const [preostaloVreme, setPreostaloVreme] = useState({});\r\n\r\n  const formatDate = (dateString) => {\r\n    const options = {\r\n      year: \"numeric\",\r\n      month: \"2-digit\",\r\n      day: \"2-digit\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n      second: \"2-digit\",\r\n      hour12: false,\r\n    };\r\n    return new Date(dateString)\r\n      .toLocaleDateString(\"en-US\", options)\r\n      .replace(\",\", \"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    var token = localStorage.getItem(\"token\");\r\n    const decodedToken = jwtDecode(token);\r\n    console.log(decodedToken[\"Id\"]);\r\n    if (!token) {\r\n      console.error(\"Token nije prisutan u localStorage-u.\");\r\n      return; // Ovde možete izvršiti odgovarajuće akcije ukoliko token nije prisutan.\r\n    }\r\n\r\n    // Pretpostavićemo da se JWT token sastoji iz tri dela (header, payload, signature) razdvojenih tačkom.\r\n    var tokenParts = token.split(\".\");\r\n    if (tokenParts.length !== 3) {\r\n      console.error(\"Neispravan format tokena.\");\r\n\r\n      return; // Ovde možete izvršiti odgovarajuće akcije ukoliko format nije ispravan.\r\n    }\r\n\r\n    fetch(\r\n      `https://localhost:44388/Porudzbina/allPorudzbineProdavcaStare?korisnikId=${decodedToken[\"Id\"]}`,\r\n      {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        mode: \"cors\",\r\n      }\r\n    )\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        console.log(data);\r\n        setPorudzbine(data);\r\n      })\r\n      .catch((error) => {\r\n        console.log(decodedToken[\"Id\"]);\r\n        console.error(\r\n          \"Greška prilikom dobavljanja podataka sa servera:\",\r\n          error\r\n        );\r\n      });\r\n  }, []);\r\n\r\n  const calculateRemainingTime = (endTime) => {\r\n    const currentTime = new Date().getTime();\r\n    const endTimeMillis = new Date(endTime).getTime();\r\n    return Math.max(0, endTimeMillis - currentTime);\r\n  };\r\n\r\n  useEffect(() => {\r\n    // ... ostatak vašeg postojećeg useEffect-a ...\r\n\r\n    // Pokretanje intervala za ažuriranje preostalog vremena svake sekunde\r\n    const interval = setInterval(() => {\r\n      const updatedRemainingTimes = {};\r\n\r\n      porudzbine.forEach((porudzbina) => {\r\n        const remainingTime = calculateRemainingTime(porudzbina.vremeIsporuke);\r\n        updatedRemainingTimes[porudzbina.id] = remainingTime;\r\n      });\r\n\r\n      setPreostaloVreme(updatedRemainingTimes);\r\n    }, 1000);\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, [porudzbine]);\r\n\r\n  const formatRemainingTime = (remainingTime) => {\r\n    const days = Math.floor(remainingTime / (24 * 60 * 60 * 1000));\r\n    const hours = Math.floor(\r\n      (remainingTime % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000)\r\n    );\r\n    const minutes = Math.floor(\r\n      (remainingTime % (60 * 60 * 1000)) / (60 * 1000)\r\n    );\r\n    const seconds = Math.floor((remainingTime % (60 * 1000)) / 1000);\r\n\r\n    return `${days}d ${hours}h ${minutes}m ${seconds}s`;\r\n  };\r\n  \r\n\r\n  return (\r\n    <div>\r\n      <h1 style={{ color: \"#279980\" }}>Moje porudzbine</h1>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th style={{ color: \"#279980\" }}>Adresa Dostave</th>\r\n            <th style={{ color: \"#279980\" }}>Komentar</th>\r\n            <th style={{ color: \"#279980\" }}>Vreme isporuke</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {porudzbine\r\n          .filter((porudzbina)=> !porudzbina.otkazana)\r\n          .map((porudzbina, index) => (\r\n            <tr key={index}>\r\n              <td>{porudzbina.adresaDostave}</td>\r\n              <td>{porudzbina.komentar}</td>\r\n              <td>\r\n                  {/* Prikaz preostalog vremena */}\r\n                  {preostaloVreme[porudzbina.id] > 0\r\n                    ? formatRemainingTime(preostaloVreme[porudzbina.id])\r\n                    : \"Isporuceno\"}\r\n                </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StarePorudzbine;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}